<!DOCTYPE html>
<html>
<head>
<title>Editing {{ ark }}</title>

<!-- JQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" integrity="sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==" crossorigin="anonymous"></script>

<!-- Helper Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.5/js/bootstrap-select.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.5/css/bootstrap-select.min.css">

<!-- Tiny MCE text editor -->
<script src="//tinymce.cachefly.net/4.2/tinymce.min.js"></script>
<script>
//tinymce.init({selector:'#biogHist', plugins:'code', min_height: 300});
</script>

<!-- CodeMirror XML editor -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/codemirror.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/codemirror.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/mode/xml/xml.js"></script>

<!-- Select Upgrades -->
<link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.2-rc.1/css/select2.min.css" rel="stylesheet" />
<script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.2-rc.1/js/select2.min.js"></script>
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

<!-- SNAC Javascript -->
<script src="javascript/save_actions.js"></script>
<script src="javascript/select_loaders.js"></script>


<!-- Code to run once the body has been loaded -->
<script language="javascript">
var biogHistEditor = null;
function updatePage() {
    $('.selectpicker').selectpicker();
    /*
        biogHistEditor = CodeMirror.fromTextArea(document.getElementById("biogHist"), {
              lineNumbers: true,
              lineWrapping: true,
              viewportMargin: Infinity,
              mode: {name: "xml"}
          });*/
}

function updateBiogHist() {
    if (biogHistEditor == null) {
        biogHistEditor = CodeMirror.fromTextArea(document.getElementById("biogHist"), {
              lineNumbers: true,
              lineWrapping: true,
              viewportMargin: Infinity,
              mode: {name: "xml"}
              });
    }
    biogHistEditor.setSize("100%", null);
    biogHistEditor.refresh();
}

function makeEditable(short, i) {
    var idstr = "_" + i;
    $("input[id^='"+short+"_']").each(function() {
        var obj = $(this);
        if(obj.attr('id').indexOf(idstr) != -1 && obj.attr('id').indexOf("ZZ") == -1) {
            obj.removeAttr("readonly");
        }
    });
    $("textarea[id^='"+short+"_']").each(function() {
        var obj = $(this);
        if(obj.attr('id').indexOf(idstr) != -1 && obj.attr('id').indexOf("ZZ") == -1) {
            obj.removeAttr("readonly");
        }
    });
    $("select[id^='"+short+"_']").each(function() {
        var obj = $(this);
        if(obj.attr('id').indexOf(idstr) != -1 && obj.attr('id').indexOf("ZZ") == -1) {
            obj.removeAttr("readonly");
        }
    });
    $("#" + short + "_operation_" + i).val("update");
    return false;
}

function setDeleted(short, i) {
    return false;
}

</script>

<style>
body {
    padding-top: 70px;
    padding-bottom: 30px;
}

.theme-dropdown .dropdown-menu {
    position: static;
    display: block;
    margin-bottom: 20px;
}

.snac > p > .btn {
    margin: 5px 0;
}

.snac .navbar .container {
    width: auto;
}
.tab-pane {

    border-left: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    border-radius: 0px 0px 5px 5px;
    padding: 10px;
}

.nav-tabs {
    margin-bottom: 0;
}
</style>
</head>
<body role="document" onLoad="updatePage();">
{% import 'widgets.html' as widgets %}
{% from 'date_entry.html' import dateEntry %}
{% from 'scm.html' import scmButton %}
{% from 'scm.html' import scmModal %}
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">SNAC</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="?">Home</a></li>
                <li><a href="?command=dashboard">Dashboard</a></li>
            </ul>
            <div class="navbar-right">
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        <img src="{{user.avatar}}" style="width:20px; height:20px; margin-right: 10px;"> {{ user.name }} <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="#">{{ user.email }}</a></li>
                        <li><a href="#">action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">User Options</li>
                        <li><a href="#">Settings</a></li>
                        <li><a href="?command=logout">Logout</a></li>
                    </ul>
                    </li>
                </ul>
            </div>
        </div><!--/.nav-collapse -->
    </div>
</nav>


<div class="container snac" role="main">

    <form class="form-horizontal" id="constellation_form">
        <h1>Editing Constellation: {{data.nameEntries.0.original}}</h1>

        <div class="alert alert-01 alert-warning" style="display: none">
            <p>Saving Constellation...</p>
        </div><!-- end alert -->
        <div class="alert alert-01 alert-success" style="display: none">
            <p>Successfully saved!</p>
        </div><!-- end alert -->
        <div class="alert alert-01 alert-danger" style="display: none">
            <p>An error occured while saving</p>
        </div><!-- end alert -->
        <div class="row">
            <div class="col-md-8">

                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#nrd" role="tab" data-toggle="tab">Basic Info</a></li>
                    <li><a href="#nameEntries" role="tab" data-toggle="tab">Name Entries</a></li>
                    <li><a href="#biogHists" role="tab" data-toggle="tab" onMouseUp="updateBiogHist()">BiogHist</a></li>
                    <li><a href="#places" role="tab" data-toggle="tab">Places</a></li>
                    <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Controlled Vocabs <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#languagesUsed" role="tab" data-toggle="tab">Languages Used</a></li>
                        <li><a href="#subjects" role="tab" data-toggle="tab">Subjects</a></li>
                        <li><a href="#occupations" role="tab" data-toggle="tab">Occupations</a></li>
                        <li><a href="#functions" role="tab" data-toggle="tab">Functions</a></li>
                    </ul>
                    </li>
                    <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Relations <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#sameAs" role="tab" data-toggle="tab">External Same As</a></li>
                        <li><a href="#constellationRelations" role="tab" data-toggle="tab">Constellation Relations</a></li>
                        <li><a href="#resourceRelations" role="tab" data-toggle="tab">Resource Relations</a></li>
                    </ul>
                    </li>
                    <li><a href="#sources" role="tab" data-toggle="tab">Sources</a></li>

                </ul>

                <div class="tab-content">

                    <div class="tab-pane active" id="nrd">
                        <h2>Non-Repeating Data</h2>
                        <!--
                        <div class="form-group">
                            <label for="ark" class="control-label col-xs-2">
                                Ark ID
                            </label>
                            <div class="col-xs-10">
                                <input id="ark" name="ark" type="text" class="form-control"  value="{{ ark }}" disabled="disabled"/>
                            </div>
                        </div>
                        -->

                        <!-- Sample text input
                        <div class="form-group">
                            <label for="entityType" class="control-label col-xs-2">
                                Entity Type
                            </label>
                            <div class="col-xs-10">
                                <input id="entityType" name="entityType" type="text" class="form-control" value="{{ entityType }}"/>
                            </div>
                        </div>
                        -->

                        <!-- Constellation Data -->
                        <input id="constellationid" name="constellationid" type="hidden" value="{{ data.id }}"/>
                        <input id="version" name="version" type="hidden" value="{{ data.version }}"/>

                        <div class="form-group">
                            <label for="entityType" class="control-label col-xs-2">
                                Entity Type
                            </label>
                            <div class="col-xs-8">
                                <select id="entityType" name="entityType" class="form-control selectpicker">
                                    <option></option>
                                    <option value="{{data.entityType.id}}" selected>{{data.entityType.term}}</option>
                                </select>
                            </div>
                            {{ scmButton('entityType', '1') }}
                            {{ scmModal('entityType', '1', 'Entity Type', "Basic Info", data.entityType) }}
                        </div>

                        <div class="form-group">
                            <label for="gender" class="control-label col-xs-2">
                                Gender
                            </label>
                            <div class="col-xs-8">
                                <select id="gender" name="gender" class="form-control selectpicker">
                                    <option></option>
                                    <option value="Female" {{ data.gender.term == 'Female' ? 'selected' }}>Female</option>
                                    <option value="Male" {{ data.gender.term == 'Male' ? 'selected' }}>Male</option>
                                </select>
                            </div>
                            {{ scmButton('gender', '1') }}
                            {{ scmModal('gender', '1', 'Gender', "Basic Info", data.gender) }}
                        </div>
                        <div class="form-group">
                            <label for="nationality" class="control-label col-xs-2">
                                Nationality
                            </label>
                            <div class="col-xs-10">
                                <input id="nationality" name="nationality" type="text" class="form-control" value="{{ data.nationality.text }}"/>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="languageCode" class="control-label col-xs-2">
                                Language
                            </label>
                            <div class="col-xs-10">
                                <select id="languageCode" name="languageCode" class="form-control selectpicker">
                                    <option></option>
                                    <option value="eng" {{ data.languagesUsed.language.term == 'eng' ? 'selected' }}>English</option>
                                    <option value="fre" {{ data.languagesUsed.language.term == 'fre' ? 'selected' }}>French</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="scriptCode" class="control-label col-xs-2">
                                Script
                            </label>
                            <div class="col-xs-10">
                                <select id="scriptCode" name="scriptCode" class="form-control selectpicker">
                                    <option></option>
                                    <option value="Latn" {{ data.languagesUsed.script.term == 'Latn' ? 'selected' }}>Latin Alphabet</option>
                                    <option value="Zyyy" {{ data.languagesUsed.script.term == 'Zyyy' ? 'selected' }}>Unknown Script</option>
                                </select>
                            </div>
                        </div>
                        {{ dateEntry('Exist Dates', 'exist', data.existDates.0) }}
                    </div>

                    <div class="tab-pane" id="nameEntries">
                        <h2>Name Entries</h2>
                        {% set i = 0 %}
                        {% for nameEntry in data.nameEntries %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <input id="nameEntry_id_{{i}}" name="nameEntry_id_{{i}}" type="hidden" value="{{ nameEntry.id }}"/>
                                <input version="nameEntry_version_{{i}}" name="nameEntry_version_{{i}}" type="hidden" value="{{ nameEntry.version }}"/>
                                <div class="form-group">
                                    <label for="nameEntry_original_{{ i }}" class="control-label col-xs-2">
                                        Original
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="nameEntry_original_{{i}}" name="nameEntry_original_{{i}}" type="text" class="form-control" value="{{ nameEntry.original }}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>

                    <div class="tab-pane" id="biogHists" style='height: auto'>
                        <h2>Biographical History</h2>

                        <p><textarea id="biogHist" name="biogHist" style="height: auto">{{ data.biogHists[0].text|e }}</textarea></p>

                    </div>

                    <div class="tab-pane" id="sameAs">
                        <h2>Same As</h2>

                        {% set i = 0 %}
                        {% for other in data.otherRecordIDs %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <div class="form-group">
                                    <label for="otherID_type_{{ i }}" class="control-label col-xs-2">
                                        Type
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="otherID_type_{{i}}" name="otherID_type_{{i}}" type="text" class="form-control" value="{{ other.type.term }}"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="otherID_href_{{ i }}" class="control-label col-xs-2">
                                        Link
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="otherID_href_{{i}}" name="otherID_href_{{i}}" type="text" class="form-control" value="{{ other.uri }}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>

                    <div class="tab-pane" id="sources">
                        <h2>Sources</h2>

                        {% set i = 0 %}
                        {% for source in data.sources %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <div class="form-group">
                                    <label for="source_href_{{ i }}" class="control-label col-xs-2">
                                        Link
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="source_href_{{i}}" name="source_href_{{i}}" type="text" class="form-control" value="{{ source.uri }}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>

                    <div class="tab-pane" id="resourceRelations">
                        <h2>Resource Relations</h2>

                        <div class="form-group">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success"><span class="glyphicon glyphicon-plus"></span> Add New Resource Relation</button>
                            </div>
                        </div>


                        {% set i = 0 %}
                        {% for relation in data.resourceRelations %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <input id="resourceRelation_id_{{i}}" name="resourceRelation_id_{{i}}" type="hidden" value="{{ relation.id }}"/>
                                <input id="resourceRelation_version_{{i}}" name="resourceRelation_version_{{i}}" type="hidden" value="{{ relation.version }}"/>
                                <input id="resourceRelation_operation_{{i}}" name="resourceRelation_operation_{{i}}" type="hidden" value=""/>
                                        <div class="col-xs-10">
                                <div class="form-group">
                                    <label for="resourceRelation_content_{{ i }}" class="control-label col-xs-4">
                                        Relation Text
                                    </label>
                                    <div class="col-xs-8">
                                        <input id="resourceRelation_content_{{i}}" name="resourceRelation_content_{{i}}" type="text" class="form-control" value="{{ relation.content }}" readonly/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="resourceRelation_role_{{ i }}" class="control-label col-xs-4">
                                        Role
                                    </label>
                                    <div class="col-xs-8">
                                        <input id="resourceRelation_role_{{i}}" name="resourceRelation_role_{{i}}" type="text" class="form-control" value="{{ relation.role.term }}" readonly/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="resourceRelation_link_{{ i }}" class="control-label col-xs-4">
                                        Link
                                    </label>
                                    <div class="col-xs-8">
                                        <input id="resourceRelation_link_{{i}}" name="resourceRelation_link_{{i}}" type="text" class="form-control" value="{{ relation.link }}" readonly/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="resourceRelation_documentType_{{ i }}" class="control-label col-xs-4">
                                        Document Type
                                    </label>
                                    <div class="col-xs-8">
                                        <input id="resourceRelation_documentType_{{i}}" name="resourceRelation_documentType_{{i}}" type="text" class="form-control" value="{{ relation.documentType.term }}" readonly/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="resourceRelation_source_{{ i }}" class="control-label col-xs-4">
                                        Source
                                    </label>
                                    <div class="col-xs-8">
                                        <textarea id="resourceRelation_source_{{i}}" name="resourceRelation_source_{{i}}" class="form-control" readonly>{{ relation.source }}</textarea>
                                    </div>
                                </div>
                            </div>

                            {{ scmModal("resourceRelation", i, relation.content, "Resource Relation", relation) }}
                            {{ widgets.optionsList("resourceRelation", i) }}
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>

                    <div class="tab-pane" id="constellationRelations">
                        <h2>Constellation Relations</h2>

                        {% set i = 0 %}
                        {% for relation in data.relations %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <input id="constellationRelation_id_{{i}}" name="constellationRelation_id_{{i}}" type="hidden" value="{{ relation.id }}"/>
                                <input version="constellationRelation_version_{{i}}" name="constellationRelation_version_{{i}}" type="hidden" value="{{ relation.version }}"/>
                                <div class="form-group">
                                    <label for="constellationRelation_content_{{ i }}" class="control-label col-xs-2">
                                        Relation Text
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="constellationRelation_content_{{i}}" name="constellationRelation_content_{{i}}" type="text" class="form-control" value="{{ relation.content }}"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="constellationRelation_targetArkID_{{ i }}" class="control-label col-xs-2">
                                        Target ArkID
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="constellationRelation_targetArkID_{{i}}" name="constellationRelation_targetArkID_{{i}}" type="text" class="form-control" value="{{ relation.targetArkID }}"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="constellationRelation_targetEntityType_{{ i }}" class="control-label col-xs-2">
                                        Target Entity Type
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="constellationRelation_targetEntityType_{{i}}" name="constellationRelation_targetEntityType_{{i}}" type="text" class="form-control" value="{{ relation.targetEntityType.term }}" disabled="disabled"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="constellationRelation_type_{{ i }}" class="control-label col-xs-2">
                                        Type
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="constellationRelation_type_{{i}}" name="constellationRelation_type_{{i}}" type="text" class="form-control" value="{{ relation.type.term }}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>


                    <div class="tab-pane" id="languagesUsed">
                        <h2>Languages Used</h2>

                        {% set i = 0 %}
                        {% for language in data.languagesUsed %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <input id="language_id_{{i}}" name="language_id_{{i}}" type="hidden" value="{{ language.id }}"/>
                                <input version="language_version_{{i}}" name="language_version_{{i}}" type="hidden" value="{{ language.version }}"/>
                                <div class="form-group">
                                    <label for="language_language_{{i}}" class="control-label col-xs-2">
                                        Language
                                    </label>
                                    <div class="col-xs-10">
											<select id="language_language_{{i}}" name="language_language_{{i}}"
												class="form-control">
												<option></option>
												<option value="{{ language.language.id }}" selected>{{ language.language.description }}</option>
											</select>
										</div>
                                </div>
                                <div class="form-group">
                                    <label for="language_script_{{i}}" class="control-label col-xs-2">
                                        Script
                                    </label>
                                    <div class="col-xs-10">
                                            <select id="language_script_{{i}}" name="language_script_{{i}}"
                                                class="form-control">
                                                <option></option>
                                                <option value="{{ language.script.id }}" selected>{{ language.script.description }}</option>
                                            </select>
                                        </div>
                                </div>
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>

                    <div class="tab-pane" id="subjects">
                        <h2>Subjects</h2>


                        <div class="form-group">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success"><span class="glyphicon glyphicon-plus"></span> Add New Subject</button>
                            </div>
                        </div>

                        {% set i = 0 %}
                        {% for subject in data.subjects %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <div class="col-xs-10">
                                    <div class="form-group">
                                        <label for="subject_{{i}}" class="control-label col-xs-2">
                                            Term
                                        </label>
                                        <div class="col-xs-8">
                                            <input type="hidden" id="subject_id_{{i}}" name="subject_id_{{i}}" value="{{subject.id}}"/>
                                            <input type="hidden" id="subject_term_id_{{i}}" name="subject_term_id_{{i}}" value="{{subject.term.id}}"/>
                                            <p class="form-control-static">{{ subject.term.term }}</p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="subject_{{i}}" class="control-label col-xs-2">
                                            URI
                                        </label>
                                        <div class="col-xs-8">
                                            {{ widgets.displayURI(subject.term.uri) }}
                                        </div>
                                    </div>
                                </div>
                                {{ scmModal("subject", i, subject.term.term, "Subject", subject) }}
                                {{ widgets.optionsList("subject", i) }}
                                <!--
                                {{ scmButton("subject", i) }}
                                {{ scmModal("subject", i, subject.term.term, "Subject", subject) }}
                            -->
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>

                    <div class="tab-pane" id="functions">
                        <h2>Functions</h2>

                        {% set i = 0 %}
                        {% for function in data.functions %}
                        <div class="form-group">
                            <input id="function_id_{{i}}" name="function_id_{{i}}" type="hidden" value="{{ function.id }}"/>
                            <input version="function_version_{{i}}" name="function_version_{{i}}" type="hidden" value="{{ function.version }}"/>
                            <div class="col-xs-10">
                                <select id="function_term_{{i}}" name="function_term_{{i}}" class="form-control">
                                    <option></option>
                                    <option value="{{ function.term.id }}" selected>{{ function.term.term }}</option>
                                </select>
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>

                    <div class="tab-pane" id="occupations">
                        <h2>Occupations</h2>

                        {% set i = 0 %}
                        {% for occupation in data.occupations %}
                        <div class="form-group">
                            <input id="occupation_id_{{i}}" name="occupation_id_{{i}}" type="hidden" value="{{ occupation.id }}"/>
                            <input version="occupation_version_{{i}}" name="occupation_version_{{i}}" type="hidden" value="{{ occupation.version }}"/>
                            <div class="col-xs-10">
                                <select id="occupation_term_{{i}}" name="occupation_term_{{i}}" class="form-control">
                                    <option></option>
                                    <option value="{{ occupation.term.id }}" selected>{{ occupation.term.term }}</option>
                                </select>
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>

                    <div class="tab-pane" id="places">
                        <h2>Places</h2>

                        {% set i = 0 %}
                        {% for place in data.places %}
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <input id="place_id_{{i}}" name="place_id_{{i}}" type="hidden" value="{{ place.id }}"/>
                                <input version="place_version_{{i}}" name="place_version_{{i}}" type="hidden" value="{{ place.version }}"/>
                                <div class="form-group">
                                    <input id="place_originalid_{{i}}" name="place_originalid_{{i}}" type="hidden" value="{{ place.entries.0.id }}"/>
                                    <input version="place_originalversion_{{i}}" name="place_originalversion_{{i}}" type="hidden" value="{{ place.entries.0.version }}"/>
                                    <label for="place_original_{{ i }}" class="control-label col-xs-2">
                                        Original
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="place_original_{{i}}" name="place_original_{{i}}" type="text" class="form-control" value="{{ place.original }}"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="place_bestMatch_{{ i }}" class="control-label col-xs-2">
                                        Geonames
                                    </label>
                                    <div class="col-xs-10">
                                        <input id="place_bestMatch_{{i}}" name="place_bestMatch_{{i}}" type="text" class="form-control" value="{{ place.geoTerm.name }}"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% set i = i + 1 %}
                        {% endfor %}

                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">User Actions</h3>
                    </div>
                    <div class="panel-body">
                        <p>You may perform any of the following actions on this constellation.</p>
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-info" id="save_and_continue"><span class="glyphicon glyphicon-floppy-disk"></span> Save &amp; Continue</a>
                            <a href="#" class="list-group-item list-group-item-success" id="save_and_dashboard"><span class="glyphicon glyphicon-floppy-saved"></span> Save &amp; Dashboard</a>
                            <a href="#" class="list-group-item list-group-item-warning" id="save_and_submit"><span class="glyphicon glyphicon-floppy-open"></span> Save &amp; Submit</a>
                            <a href="#" class="list-group-item list-group-item-danger" id="cancel"><span class="glyphicon glyphicon-floppy-remove"></span> Cancel</a>
                        </div>
                    </div>
                </div>
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">Constellation Info</h3>
                    </div>
                    <div class="panel-body">
                        <div class="form-group">
                            <label for="ark" class="control-label col-xs-2">
                                Ark
                            </label>
                            <div class="col-xs-10">
                                <p class="form-control-static">{{ data.ark }}</p>
                            </div>
                            <input id="ark" name="ark" type="hidden" value="{{ data.ark }}"/>
                        </div>
                    </div>
                </div>
                <div class="panel panel-danger">
                    <div class="panel-heading">
                        <h3 class="panel-title">Debugging</h3>
                    </div>
                    <div class="panel-body">
                        <p>The following are debugging options.</p>
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-danger" data-toggle="modal" data-target="#sourceConstellation"><span class="glyphicon glyphicon-eye-open"></span> View Constellation</a>
                            <a href="#" class="list-group-item list-group-item-danger" data-toggle="modal" data-target="#serverResponse"><span class="glyphicon glyphicon-log-in"></span> View Full Server Response</a>
                        </div>
                    </div>
                </div>

                <div class="modal fade" id="sourceConstellation" tabindex="-1" role="dialog" aria-labelledby="sourceConstellationLabel">
                  <div class="modal-dialog" role="document" style="width:90%;">
                    <div class="modal-content">
                      <div class="modal-header primary">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="sourceConstellationLabel">Constellation Source (JSON)</h4>
                      </div>
                      <div class="modal-body">
                        <pre>{{debug.constellationSource}}
                        </pre>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-primary"  data-dismiss="modal">Done</button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="modal fade" id="serverResponse" tabindex="-1" role="dialog" aria-labelledby="serverResponseLabel">
                  <div class="modal-dialog" role="document" style="width:90%;">
                    <div class="modal-content">
                      <div class="modal-header primary">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="serverResponseLabel">Server Response (JSON)</h4>
                      </div>
                      <div class="modal-body">
                        <pre>{{debug.serverResponse}}
                        </pre>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-primary"  data-dismiss="modal">Done</button>
                      </div>
                    </div>
                  </div>
                </div>

            </div>
        </div>
    </form>






</div>
</body>
</html>
