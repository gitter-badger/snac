<!DOCTYPE html>
<html>
<head>
{% if data.id %}
    <title>SNAC Editing: {{data.nameEntries.0.original}}</title>
{% else %}
    <title>SNAC Editing: New Constellation</title>
{% endif %}

<!-- JQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<link href="//code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" type="text/css" rel="stylesheet" media="all">
<script type='text/javascript' src="//code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" integrity="sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==" crossorigin="anonymous"></script>

<!-- Helper Scripts -->
<!--
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.5/js/bootstrap-select.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.5/css/bootstrap-select.min.css">
-->

<!-- Tiny MCE text editor
<script src="//cdn.tinymce.com/4/tinymce.min.js"></script>
<script>
//tinymce.init(X, {selector:'#biogHist', plugins:'code', min_height: 300});
</script>
-->

<!-- CodeMirror XML editor -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/codemirror.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/codemirror.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/mode/xml/xml.js"></script>

<!-- Select Upgrades -->
<link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.2-rc.1/css/select2.min.css" rel="stylesheet" />
<script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.2-rc.1/js/select2.min.js"></script>
<link rel="stylesheet" href="css/select2-bootstrap.min.css">

<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

<!-- Leaflet JS Javascript and Styles-->
<link rel="stylesheet" href="https://npmcdn.com/leaflet@1.0.0-rc.3/dist/leaflet.css" />
<script src="https://npmcdn.com/leaflet@1.0.0-rc.3/dist/leaflet.js"></script>

<!-- SNAC Javascript -->
<script src="javascript/save_actions.js"></script>
<script src="javascript/select_loaders.js"></script>
<script src="javascript/scripts.js"></script>
<script src="javascript/relation_search.js"></script>

<script>
$.fn.modal.Constructor.prototype.enforceFocus = $.noop;
</script>

<!-- SNAC Stylesheet -->
<link rel="stylesheet" href="css/snac.css">

</head>
<body role="document">
{% import 'widgets.html' as widgets %}
{% import 'edit_components.html' as components %}
{% import 'date_entry.html' as dates %}


{% from 'page_navigation.html' import topNavigation %}
{{ topNavigation(X, user, permissions) }}


<div class="container snac" role="main">

    <form class="form-horizontal" id="constellation_form">
        {% if data.id %}
            <h1>Editing: {{data.nameEntries.0.original}}</h1>
        {% else %}
            <h1>New Constellation</h1>
        {% endif %}

        <!-- Constellation Data -->
        <input id="constellationid" name="constellationid" type="hidden" value="{{ data.id }}"/>
        <input id="version" name="version" type="hidden" value="{{ data.version }}"/>
        <input id="operation" name="operation" type="hidden" value="{{ data.operation }}"/>


        <div class="row">
            <div class="col-md-8">

                <div class="well well-lg">
                    <p><span style="font-weight: bold;">Instructions: </span> When saving an Identity Constellation, the <em>Entity Type</em> and at least one <em>Name Entry</em> are required.</p>
                </div>


                <!-- Nav tabs -->
                {{ components.displayEditTabs(X) }}

                <div class="tab-content">

                    <div class="tab-pane active" id="nameEntries">
                        <h2>Core Data</h2>

                        <div class="panel panel-default">
                        	<div class="panel-heading">Constellation Information</div>
                            <div class="panel-body">
                                <div class="col-xs-10">
                                    <div class="form-group">
                                        <label for="entityType" class="control-label col-xs-4" data-content="{{X.entitytype.tooltip}}" data-toggle="popover" data-placement="top">
                                            {{X.entitytype.display}} <span style="color: #b40404">*</span>
                                        </label>
                                        <div class="col-xs-8">
                                            <select id="entityType" name="entityType" class="form-control">
                                                <option></option>
                                                <option value="{{data.entityType.id}}" selected>{{data.entityType.term}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <!--
                                    <div class="form-group">
                                        <label for="entityType" class="control-label col-xs-4"  data-content="{{X.snaccontrolmetadata.tooltip}}" data-toggle="popover" data-placement="top">
                                            {{X.snaccontrolmetadata.display}}
                                        </label>
                                        <div class="col-xs-8">
                                            <button type="button" class="btn btn-default" onClick="$('#sources-tab').click();">
                                                Sources
                                            </button>
                                        </div>
                                    </div>
                                    -->
                                </div>
                                {{ widgets.scmModal(X, true, true, 'constellation', '1', 'Basic Info', "Constellation", data) }}
                            </div>
                        </div>

                        <div class="panel panel-default">
                        	<div class="panel-heading">Name Entries <span style="color: #b40404">*</span></div>
                            <div class="panel-body" id="nameEntry_pane">
                                <div class="form-group" id="add_nameEntry_div">
                                    <div class="col-xs-12 text-center">
                                        <button class="btn btn-success" id="btn_add_nameEntry"><span class="glyphicon glyphicon-plus"></span> Add New Name Entry</button>
                                    </div>
                                </div>

                                {% set i = 0 %}
                                {% for nameEntry in data.nameEntries %}
                                    {{ components.displayNameEntry(X, true, true, nameEntry, i) }}
                                {% set i = i + 1 %}
                                {% endfor %}
                                <span id='next_nameEntry_i' style='display:none;'>{{i}}</span>
                            </div>
                        </div>


                    </div>

                    <div class="tab-pane" id="genders">
                        <h2>Genders</h2>

                        <div class="form-group" id="add_gender_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_gender"><span class="glyphicon glyphicon-plus"></span> Add New Gender</button>
                            </div>
                        </div>



                        {% set i = 0 %}
                        {% for gender in data.genders %}
                            {{ components.displayGender(X, true, true, gender, i) }}
                            {% set i = i + 1 %}
                        {% endfor %}

                        <span id='next_gender_i' style='display:none;'>{{i}}</span>


                    </div>

                    <div class="tab-pane" id="dates">
                        <h2>Exist Dates</h2>

                        <div class="form-group" id="add_exist_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_exist_date"><span class="glyphicon glyphicon-plus"></span> Add New Date</button>
                                <button class="btn btn-success" id="btn_add_exist_dateRange"><span class="glyphicon glyphicon-plus"></span> Add New Date Range</button>
                            </div>
                        </div>

                        {% set i = 0 %}
                        {% for exist in data.dates %}
                            {{ components.displayExist(X, true, true, exist, i) }}
                            {% set i = i + 1 %}
                        {% endfor %}

                    </div>


                    <div class="tab-pane" id="biogHists" style='height: auto'>
                        <h2>Biographical History</h2>

                        {% if data.biogHists is empty %}
                            {{ components.displayBiogHist(X, true, true, null, 0) }}
                        {% else %}
                            {% set i = 0 %}
                            {% for biogHist in data.biogHists %}
                                {{ components.displayBiogHist(X, true, true, biogHist, i) }}
                                {% set i = i + 1 %}
                            {% endfor %}
                        {% endif %}

                    </div>

                    <div class="tab-pane" id="sameAs">
                        <h2>External CPF Relations (Same As)</h2>

                        <div class="form-group" id="add_sameAs_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_sameAs"><span class="glyphicon glyphicon-plus"></span> Add New Same-As Relation</button>
                            </div>
                        </div>


                        {% set i = 0 %}
                        {% for other in data.otherRecordIDs %}
                            {{ components.displaySameAs(X, true, true, other, i) }}
                        {% set i = i + 1 %}
                        {% endfor %}
                        <span id='next_sameAs_i' style='display:none;'>{{i}}</span>


                    </div>

                    <div class="tab-pane" id="entityID">
                        <h2>Other Entity IDs (Same As)</h2>

                        <div class="form-group" id="add_entityID_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_entityID"><span class="glyphicon glyphicon-plus"></span> Add New Entity ID</button>
                            </div>
                        </div>


                        {% set i = 0 %}
                        {% for other in data.entityIDs %}
                            {{ components.displayEntityID(X, true, true, other, i) }}
                            {% set i = i + 1 %}
                        {% endfor %}
                        <span id='next_entityID_i' style='display:none;'>{{i}}</span>


                    </div>

                    <div class="tab-pane" id="sources">
                        <h2>Sources</h2>

                        <div class="form-group" id="add_source_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_source"><span class="glyphicon glyphicon-plus"></span> Add New Source</button>
                            </div>
                        </div>

                        {% set i = 0 %}
                        {% for source in data.sources %}
                            {{ components.displaySource(X, true, true, source, i) }}
                        {% set i = i + 1 %}
                        {% endfor %}
                        <span id='next_source_i' style='display:none;'>{{i}}</span>

                    </div>

                    <div class="tab-pane" id="resourceRelations">
                        <h2>Resource Relations</h2>

                        <div class="form-group" id="add_resourceRelation_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_resourceRelation"><span class="glyphicon glyphicon-plus"></span> Add New Resource Relation</button>
                            </div>
                        </div>


                        {% set i = 0 %}
                        {% for relation in data.resourceRelations %}
                            {{ components.displayResourceRelation(X, true, true, relation, i) }}
                        {% set i = i + 1 %}
                        {% endfor %}
                        <span id='next_resourceRelation_i' style='display:none;'>{{i}}</span>

                    </div>

                    <div class="tab-pane" id="constellationRelations">
                        <h2>Internal CPF Relations</h2>

                        <div class="form-group" id="add_constellationRelation_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_constellationRelation" data-toggle="modal" data-target="#relationSearchPane" onClick='return false;'><span class="glyphicon glyphicon-plus"></span> Add New Constellation Relation</button>
                            </div>
                        </div>

                        {% set i = 0 %}
                        {% for relation in data.relations %}
                            {{ components.displayConstellationRelation(X, true, true, relation, i) }}
                        {% set i = i + 1 %}
                        {% endfor %}
                        <span id='next_constellationRelation_i' style='display:none;'>{{i}}</span>

                    </div>


                    <div class="tab-pane" id="languagesUsed">
                        <h2>Languages Used</h2>

                        <div class="form-group" id="add_language_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_language"><span class="glyphicon glyphicon-plus"></span> Add New Language</button>
                            </div>
                        </div>

                        {% set i = 0 %}
                        {% for language in data.languagesUsed %}
                            {{ components.displayLanguageUsed(X, true, true, language, i) }}
                        {% set i = i + 1 %}
                        {% endfor %}
                        <span id='next_language_i' style='display:none;'>{{i}}</span>

                    </div>

                    <div class="tab-pane" id="subjects">
                        <h2>Subjects</h2>


                        <div class="form-group" id="add_subject_div">
                            <div class="col-xs-12 text-center">
                                <button class="btn btn-success" id="btn_add_subject"><span class="glyphicon glyphicon-plus"></span> Add New Subject</button>
                            </div>
                        </div>

                        {% set i = 0 %}
                        {% for subject in data.subjects %}
                            {{ components.displaySubject(X, true, true, subject, i) }}
                        {% set i = i + 1 %}
                        {% endfor %}
                        <span id='next_subject_i' style='display:none;'>{{i}}</span>

                        </div>

                        <div class="tab-pane" id="nationalities">
                            <h2>Nationalities</h2>


                            <div class="form-group" id="add_nationality_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_nationality"><span class="glyphicon glyphicon-plus"></span> Add New Nationality</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for nationality in data.nationalities %}
                                {{ components.displayNationality(X, true, true, nationality, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_nationality_i' style='display:none;'>{{i}}</span>
                        </div>

                        <div class="tab-pane" id="functions">
                            <h2>Functions</h2>


                            <div class="form-group" id="add_function_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_function"><span class="glyphicon glyphicon-plus"></span> Add New Function</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for function in data.functions %}
                                {{ components.displayFunction(X, true, true, function, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_function_i' style='display:none;'>{{i}}</span>

                        </div>

                        <div class="tab-pane" id="occupations">
                            <h2>Occupations</h2>

                            <div class="form-group" id="add_occupation_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_occupation"><span class="glyphicon glyphicon-plus"></span> Add New Occupation</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for occupation in data.occupations %}
                                {{ components.displayOccupation(X, true, true, occupation, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_occupation_i' style='display:none;'>{{i}}</span>

                        </div>

                        <div class="tab-pane" id="legalStatuses">
                            <h2>Legal Statuses</h2>

                            <div class="form-group" id="add_legalStatus_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_legalStatus"><span class="glyphicon glyphicon-plus"></span> Add New Legal Status</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for legalStatus in data.legalStatuses %}
                                {{ components.displayLegalStatus(X, true, true, legalStatus, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_legalStatus_i' style='display:none;'>{{i}}</span>

                        </div>

                        <div class="tab-pane" id="places">
                            <h2>Places</h2>

                            <div class="form-group" id="add_place_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_place"><span class="glyphicon glyphicon-plus"></span> Add New Place</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for place in data.places %}
                                {{ components.displayPlace(X, true, true, place, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_place_i' style='display:none;'>{{i}}</span>

                        </div>

                        <div class="tab-pane" id="conventionDeclarations">
                            <h2>Convention Declarations</h2>

                            <div class="form-group" id="add_conventionDeclaration_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_conventionDeclaration"><span class="glyphicon glyphicon-plus"></span> Add New Convention Declaration</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for conventionDeclaration in data.conventionDeclarations %}
                                {{ components.displayConventionDeclaration(X, true, true, conventionDeclaration, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_conventionDeclaration_i' style='display:none;'>{{i}}</span>
                        </div>

                        <div class="tab-pane" id="generalContexts">
                            <h2>General Contexts</h2>

                            <div class="form-group" id="add_generalContext_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_generalContext"><span class="glyphicon glyphicon-plus"></span> Add New General Context</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for generalContext in data.generalContexts %}
                                {{ components.displayGeneralContext(X, true, true, generalContext, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_generalContext_i' style='display:none;'>{{i}}</span>
                        </div>

                        <div class="tab-pane" id="structureOrGenealogies">
                            <h2>Structure or Genealogies</h2>

                            <div class="form-group" id="add_structureOrGenealogy_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_structureOrGenealogy"><span class="glyphicon glyphicon-plus"></span> Add New Structure or Genealogy</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for structureOrGenealogy in data.structureOrGenealogies %}
                                {{ components.displayStructureOrGenealogy(X, true, true, structureOrGenealogy, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_structureOrGenealogy_i' style='display:none;'>{{i}}</span>
                        </div>

                        <div class="tab-pane" id="mandates">
                            <h2>Mandates</h2>

                            <div class="form-group" id="add_mandate_div">
                                <div class="col-xs-12 text-center">
                                    <button class="btn btn-success" id="btn_add_mandate"><span class="glyphicon glyphicon-plus"></span> Add New Mandate</button>
                                </div>
                            </div>

                            {% set i = 0 %}
                            {% for mandate in data.mandates %}
                                {{ components.displayMandate(X, true, true, mandate, i) }}
                            {% set i = i + 1 %}
                            {% endfor %}
                            <span id='next_mandate_i' style='display:none;'>{{i}}</span>
                        </div>



                    </div>
                </div>
                <div class="col-md-4">
                    <!-- Right Column -->

                    <div class="alert alert-01 alert-warning" id="notification-message" style="display: none">
                        <p>Saving Constellation...</p>
                    </div><!-- end alert -->
                    <div class="alert alert-01 alert-success" id="success-message" style="display: none">
                        <p>Successfully saved!</p>
                    </div><!-- end alert -->
                    <div class="alert alert-01 alert-danger" id="error-message"  style="display: none">
                        <p>An error occured while saving</p>
                    </div><!-- end alert -->

                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h3 class="panel-title">User Actions</h3>
                        </div>
                        <div class="panel-body">
                            <p>You may perform any of the following actions on this constellation.</p>
                            <!--
                            <div class="list-group">
                                <a href="#" class="list-group-item list-group-item-success" id="preview"><span class="glyphicon glyphicon-eye-open"></span> Preview</a>
                            </div>
                            -->
                            <div class="list-group">
                                <a href="#" class="list-group-item list-group-item-info" id="save_and_continue"><span class="glyphicon glyphicon-floppy-disk"></span> Save &amp; Continue <span class="pull-right glyphicon glyphicon-question-sign" title="Help" data-content="Save the current state of the constellation and continue working." data-toggle="popover" data-placement="top"></span></a>
                                <a href="#" class="list-group-item list-group-item-success" id="save_and_dashboard"><span class="glyphicon glyphicon-floppy-saved"></span> Save &amp; Dashboard <span class="pull-right glyphicon glyphicon-question-sign" title="Help" data-content='Save the current state of the constellation and return to the dashboard.  It will not be published, but will remain in your "In Progress Edits" list.' data-toggle="popover" data-placement="top"></span></a>
                                <a href="#" class="list-group-item list-group-item-review" id="save_and_review"><span class="glyphicon glyphicon-send"></span> Save &amp; Send for Review <span class="pull-right glyphicon glyphicon-question-sign" title="Help" data-content='Save the current state of the constellation and send it to the reviewers.  It will be removed from your "In Progress Edits" list.'  data-toggle="popover" data-placement="top"></span></a>
                                {% if permissions.Publish %}
                                <a href="#" class="list-group-item list-group-item-warning" id="save_and_publish"><span class="glyphicon glyphicon-floppy-open"></span> Save &amp; Publish <span class="pull-right glyphicon glyphicon-question-sign" title="Help" data-content='Save the current state of the constellation and publish it.  The changes will be globally visible and it will be removed from your "In Progress Edits" list.'  data-toggle="popover" data-placement="top"></span></a>
                                {% endif %}
                                <a href="#" class="list-group-item list-group-item-danger" id="cancel"><span class="glyphicon glyphicon-floppy-remove"></span> Cancel <span class="pull-right glyphicon glyphicon-question-sign" title="Help" data-content="Cancel any changes.  The constellation will still be locked to you until published." data-toggle="popover" data-placement="top"></span></a>
                            </div>

                            <textarea id="savemessage" name="savemessage" class='panel panel-default panel-body' style='width: 100%' placeholder="You may write an optional save log message here..."></textarea>
                        </div>
                    </div>
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h3 class="panel-title">Identity Constellation Identifier(s)</h3>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label for="ark" class="control-label col-xs-3" data-content="{{X.ark.tooltip}}" data-toggle="popover" data-placement="top">
                                    {{ X.ark.display }}
                                </label>
                                <div class="col-xs-9">
                                    <p class="form-control-static">{{ data.ark }}</p>
                                </div>
                                <input id="ark" name="ark" type="hidden" value="{{ data.ark }}"/>
                            </div>
                        </div>
                    </div>

                    {% if debug %}
                    <div class="panel panel-danger">
                        <div class="panel-heading">
                            <h3 class="panel-title">Debugging</h3>
                        </div>
                        <div class="panel-body">
                            <p>The following are debugging options.</p>
                            <div class="list-group">
                                <a href="#" class="list-group-item list-group-item-danger" data-toggle="modal" data-target="#sourceConstellation"><span class="glyphicon glyphicon-eye-open"></span> View Constellation</a>
                                <a href="#" class="list-group-item list-group-item-danger" data-toggle="modal" data-target="#serverResponse"><span class="glyphicon glyphicon-log-in"></span> View Full Server Response</a>
                            </div>
                        </div>
                    </div>

                    <div class="modal fade" id="sourceConstellation" tabindex="-1" role="dialog" aria-labelledby="sourceConstellationLabel">
                        <div class="modal-dialog" role="document" style="width:90%;">
                            <div class="modal-content">
                                <div class="modal-header primary">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="sourceConstellationLabel">Constellation Source (JSON)</h4>
                                </div>
                                <div class="modal-body">
                                    <pre>{{debug.constellationSource}}
                                    </pre>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary"  data-dismiss="modal">Done</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal fade" id="serverResponse" tabindex="-1" role="dialog" aria-labelledby="serverResponseLabel">
                        <div class="modal-dialog" role="document" style="width:90%;">
                            <div class="modal-content">
                                <div class="modal-header primary">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title" id="serverResponseLabel">Server Response (JSON)</h4>
                                </div>
                                <div class="modal-body">
                                    <pre>{{debug.serverResponse}}
                                    </pre>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary"  data-dismiss="modal">Done</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {% endif %}

                </div>
            </div>
        </form>


    <div id="hidden_field_options" style="display:none">
    <div id="gender_template" style="display:none">
    {{ components.displayGender(X, true, true, null, 'ZZ') }}
    </div>
    <div id="nameEntry_template" style="display:none">
    {{ components.displayNameEntry(X, true, true, null, 'ZZ') }}
    </div>
    <div id="sameAs_template" style="display:none">
    {{ components.displaySameAs(X, true, true, null, 'ZZ') }}
    </div>
    <div id="entityID_template" style="display:none">
    {{ components.displayEntityID(X, true, true, null, 'ZZ') }}
    </div>
    <div id="source_template" style="display:none">
    {{ components.displaySource(X, true, true, null, 'ZZ') }}
    </div>
    <div id="resourceRelation_template" style="display:none">
    {{ components.displayResourceRelation(X, true, true, null, 'ZZ') }}
    </div>
    <div id="constellationRelation_template" style="display:none">
    {{ components.displayConstellationRelation(X, true, true, null, 'ZZ') }}
    </div>
    <div id="language_template" style="display:none">
    {{ components.displayLanguageUsed(X, true, true, null, 'ZZ') }}
    </div>
    <div id="subject_template" style="display:none">
    {{ components.displaySubject(X, true, true, null, 'ZZ') }}
    </div>
    <div id="nationality_template" style="display:none">
    {{ components.displayNationality(X, true, true, null, 'ZZ') }}
    </div>
    <div id="function_template" style="display:none">
    {{ components.displayFunction(X, true, true, null, 'ZZ') }}
    </div>
    <div id="occupation_template" style="display:none">
    {{ components.displayOccupation(X, true, true, null, 'ZZ') }}
    </div>
    <div id="legalStatus_template" style="display:none">
    {{ components.displayLegalStatus(X, true, true, null, 'ZZ') }}
    </div>
    <div id="place_template" style="display:none">
    {{ components.displayPlace(X, true, true, null, 'ZZ') }}
    </div>
    <div id="conventionDeclaration_template" style="display:none">
    {{ components.displayConventionDeclaration(X, true, true, null, 'ZZ') }}
    </div>
    <div id="generalContext_template" style="display:none">
    {{ components.displayGeneralContext(X, true, true, null, 'ZZ') }}
    </div>
    <div id="structureOrGenealogy_template" style="display:none">
    {{ components.displayStructureOrGenealogy(X, true, true, null, 'ZZ') }}
    </div>
    <div id="mandate_template" style="display:none">
    {{ components.displayMandate(X, true, true, null, 'ZZ') }}
    </div>
    <div id="exist_date_template" style="display:none">
    {{ dates.dateEntry(X, true, true, 'Exist Dates', 'exist', null, 'ZZ', false) }}
    </div>
    <div id="exist_dateRange_template" style="display:none">
    {{ dates.dateRangeEntry(X, true, true, 'Exist Dates', 'exist', null, 'ZZ', false) }}
    </div>
    <div id="sub_date_template" style="display:none">
    {{ dates.dateEntry(X, true, true, 'Date', 'SHORT_date_XX', null, 'ZZ', true) }}
    </div>
    <div id="sub_dateRange_template" style="display:none">
    {{ dates.dateRangeEntry(X, true, true, 'Date Range', 'SHORT_date_XX', null, 'ZZ', true) }}
    </div>
    <div id="scm_template" style="display:none">
    {{ components.displaySCM(X, true, true, 'SHORT', 'ZZ', 'YY', null) }}
    </div>
    <div id="component_template" style="display:none">
    {{ components.displayComponent(X, true, true, null, 'ZZ', 'YY') }}
    </div>
    <div id="contributor_template" style="display:none">
    {{ components.displayContributor(X, true, true, null, 'ZZ', 'YY') }}
    </div>
    <div id="addressline_template" style="display:none">
    {{ components.displayAddressLine(X, true, true, null, 'ZZ', 'YY') }}
    </div>
    </div>


<div class="modal fade" id="previewPane" tabindex="-1" role="dialog" aria-labelledby="previewPane">
    <div class="modal-dialog" role="document" style="width:90%;">
        <div class="modal-content">
            <div class="modal-header primary">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="previewLabel">Preview</h4>
            </div>
            <div class="modal-body" id="previewPaneContent">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary"  data-dismiss="modal">Done</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="relationSearchPane" tabindex="-1" role="dialog" aria-labelledby="relationSearchPane">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header primary">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="relationSearchLabel">Choose Relationship</h4>
            </div>
            <div class="modal-body" id="relationSearchPaneContent">
                <form class="form-horizontal" id="relation_search_form" onsubmit="return false;">
                    <div class="modal-body">
                        <p>Use the search box below to find a Constellation.  Select one by using the radio button to the left. You may view any constellation
                        by choosing the "View" link next to the ARK</p>
	                    <input type="hidden" id="relation-search-count" name="count" value="10">
	                    <input type="hidden" id="relation-search-start" name="start" value="0">
	                    <div class="form-group">
	                        <input type="text" class="form-control"
	                            placeholder="Search for..." id="relation-searchbox" name="term">
	                    </div>

	                    <div id="relation-results-box">
	                    </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Cancel</span></button>
                <button type="button" class="btn btn-primary" id="btn_create_constellationRelation" data-dismiss="modal">Create Relation</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="geoPlaceInfoPane" tabindex="-1" role="dialog" aria-labelledby="geoPlaceInfoPane">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header primary">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="geoPlaceInfoPaneLabel">GeoPlace Information</h4>
            </div>
            <div class="modal-body" id="geoPlaceInfoPaneContent">
                <div class="geoplace-map" id="geoPlaceMap"></div>
                <div id="geoPlaceInfo"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Done</span></button>
            </div>
        </div>
    </div>
</div>

    </div>
    </body>
    </html>
